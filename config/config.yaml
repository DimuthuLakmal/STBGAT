# Model Configs
model:
  batch_size: 4
  epochs: 100
  model_output_path: "output/model/pemsd7/multi-cross-attn/epoch_v1_{}_model.pt"
  model_input_path: "output/model/pemsd7/multi-cross-attn/epoch_v1_40_model.pt"
  load_saved_model: False
  device: cuda
  transformer:
    encoder:
      features: 2 # To indicates multiple encoders (feature-wise). default is 1
      emb_dim: 16
      seq_len: 24
      input_dim: 1
      merge_emb: False # Indicate whether the graph embeddings merge with non-graph embedding.
      emb_expansion_factor: 3 # If embeddings are merged, it will expand the dimension. the factor depends on whether we use graph, semantinc graph and raw sensor data.
      n_layers: 4
      local_trends: True
      graph_semantic_input: False
      graph_input: True
      encoder_block:
        n_heads: 8
        expansion_factor: 4
        src_dropout: 0.2
        ff_dropout: 0.2
      sgat:
        first_in_f_size: 384
        n_layers: 1
        out_f_sizes: [ 16, 16 ]
        n_heads: [ 4, 1 ]
        alpha: 0.2
        dropout: 0.7
        edge_dim: 1
        skip_conn: False
    decoder:
      emb_dim: 16
      seq_len: 13
      seq_offset: 1 # Indicates how many timesteps in the previous hour consider as inputs in the decoder
      input_dim: 1
      n_layers: 4
      merge_emb: False # Indicate whether the graph embeddings merge with non-graph embedding.
      emb_expansion_factor: 3 # If embeddings are merged, it will expand the dimension. the factor depends on whether we use graph, semantinc graph and raw sensor data.
      out_dim: 1
      out_start_idx: 0 # When set decoder offset, this indicates the start index of the decoder output to calculate loss
      out_end_idx: -1 # When set decoder offset, this indicates the end index of the decoder output to calculate loss
      per_enc_feature_len: 24 # used in decoder cross attention (feature-wise cross attention). This should be tuned along with cross_attn_features
      local_trends: True
      graph_semantic_input: False
      graph_input: True
      decoder_block:
        n_heads: 8
        expansion_factor: 4
        cross_attn_features: 2 # Used to indicates how many feature-wise cross attentions in the decoder
        src_dropout: 0.2
        cross_attn_dropout: 0.2
        ff_dropout: 0.2
      sgat:
        first_in_f_size: 208
        n_layers: 1
        out_f_sizes: [ 16, 16 ]
        n_heads: [ 4, 1 ]
        alpha: 0.2
        dropout: 0.7
        edge_dim: 1
        skip_conn: False
    lookup_index: True

# Data Configs
data:
  edge_weight_filename: "data/PEMSD7/PeMSD7_W_228.csv"
  edge_weight_original_filename: "data/PEMSD7/PeMSD7_W_228_original.csv"
  semantic_adj_filename: "data/PEMSD7/PeMSD7_W_228.pickle"
  edge_weight_scaling: True
  node_data_filename: "data/PEMSD7/PeMSD7_V_228.csv"
  num_of_vertices: 228
  points_per_hour: 12
  len_input: 12
  last_week: False
  last_day: True
  num_days_per_week: 5
  rep_vectors: True
  preprocess: False
  preprocess_output_path: "data/PEMSD7/PeMSD7_Preprocessed.pickle"